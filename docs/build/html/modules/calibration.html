

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Calibration &mdash; figaroh 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=01f34227"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Measurements" href="measurements.html" />
    <link rel="prev" title="Identification" href="identification.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            figaroh
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="identification.html">Identification</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Calibration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#calibration-tools">calibration_tools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#figaroh.calibration.calibration_tools.add_base_name"><code class="docutils literal notranslate"><span class="pre">add_base_name()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#figaroh.calibration.calibration_tools.add_eemarker_frame"><code class="docutils literal notranslate"><span class="pre">add_eemarker_frame()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#figaroh.calibration.calibration_tools.add_pee_name"><code class="docutils literal notranslate"><span class="pre">add_pee_name()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#figaroh.calibration.calibration_tools.calc_updated_fkm"><code class="docutils literal notranslate"><span class="pre">calc_updated_fkm()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#figaroh.calibration.calibration_tools.calculate_base_kinematics_regressor"><code class="docutils literal notranslate"><span class="pre">calculate_base_kinematics_regressor()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#figaroh.calibration.calibration_tools.calculate_identifiable_kinematics_model"><code class="docutils literal notranslate"><span class="pre">calculate_identifiable_kinematics_model()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#figaroh.calibration.calibration_tools.calculate_kinematics_model"><code class="docutils literal notranslate"><span class="pre">calculate_kinematics_model()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#figaroh.calibration.calibration_tools.cartesian_to_SE3"><code class="docutils literal notranslate"><span class="pre">cartesian_to_SE3()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#figaroh.calibration.calibration_tools.get_LMvariables"><code class="docutils literal notranslate"><span class="pre">get_LMvariables()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#figaroh.calibration.calibration_tools.get_geo_offset"><code class="docutils literal notranslate"><span class="pre">get_geo_offset()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#figaroh.calibration.calibration_tools.get_joint_offset"><code class="docutils literal notranslate"><span class="pre">get_joint_offset()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#figaroh.calibration.calibration_tools.get_param_from_yaml"><code class="docutils literal notranslate"><span class="pre">get_param_from_yaml()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#figaroh.calibration.calibration_tools.get_rel_jac"><code class="docutils literal notranslate"><span class="pre">get_rel_jac()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#figaroh.calibration.calibration_tools.get_rel_kinreg"><code class="docutils literal notranslate"><span class="pre">get_rel_kinreg()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#figaroh.calibration.calibration_tools.get_rel_transform"><code class="docutils literal notranslate"><span class="pre">get_rel_transform()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#figaroh.calibration.calibration_tools.get_sup_joints"><code class="docutils literal notranslate"><span class="pre">get_sup_joints()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#figaroh.calibration.calibration_tools.load_data"><code class="docutils literal notranslate"><span class="pre">load_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#figaroh.calibration.calibration_tools.rank_in_configuration"><code class="docutils literal notranslate"><span class="pre">rank_in_configuration()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#figaroh.calibration.calibration_tools.read_config_data"><code class="docutils literal notranslate"><span class="pre">read_config_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#figaroh.calibration.calibration_tools.update_forward_kinematics"><code class="docutils literal notranslate"><span class="pre">update_forward_kinematics()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#figaroh.calibration.calibration_tools.update_forward_kinematics_2"><code class="docutils literal notranslate"><span class="pre">update_forward_kinematics_2()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#figaroh.calibration.calibration_tools.update_joint_placement"><code class="docutils literal notranslate"><span class="pre">update_joint_placement()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#figaroh.calibration.calibration_tools.xyzquat_to_SE3"><code class="docutils literal notranslate"><span class="pre">xyzquat_to_SE3()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="measurements.html">Measurements</a></li>
<li class="toctree-l1"><a class="reference internal" href="tools.html">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualisation.html">Visualisation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">figaroh</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Calibration</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/modules/calibration.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="calibration">
<h1>Calibration<a class="headerlink" href="#calibration" title="Link to this heading"></a></h1>
<section id="calibration-tools">
<h2>calibration_tools<a class="headerlink" href="#calibration-tools" title="Link to this heading"></a></h2>
<dl class="py function" id="module-figaroh.calibration.calibration_tools">
<dt class="sig sig-object py" id="figaroh.calibration.calibration_tools.add_base_name">
<span class="sig-prename descclassname"><span class="pre">figaroh.calibration.calibration_tools.</span></span><span class="sig-name descname"><span class="pre">add_base_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/figaroh/calibration/calibration_tools.html#add_base_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#figaroh.calibration.calibration_tools.add_base_name" title="Link to this definition"></a></dt>
<dd><p>Add base frame parameters to parameter list.</p>
<p>Updates param[“param_name”] with base frame parameters depending on
calibration model type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>param</strong> – Parameter dictionary containing:
- calib_model: “full_params” or “joint_offset”
- param_name: List of parameter names to update</p>
</dd>
</dl>
<dl class="simple">
<dt>Side Effects:</dt><dd><p>Modifies param[“param_name”] in place by:
- For full_params: Replaces first 6 entries with base parameters
- For joint_offset: Prepends base parameters to list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="figaroh.calibration.calibration_tools.add_eemarker_frame">
<span class="sig-prename descclassname"><span class="pre">figaroh.calibration.calibration_tools.</span></span><span class="sig-name descname"><span class="pre">add_eemarker_frame</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frame_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rpy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/figaroh/calibration/calibration_tools.html#add_eemarker_frame"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#figaroh.calibration.calibration_tools.add_eemarker_frame" title="Link to this definition"></a></dt>
<dd><p>Add a new frame attached to the end-effector.</p>
<p>Creates and adds a fixed frame to the robot model at the end-effector location,
typically used for marker or tool frames.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frame_name</strong> (<em>str</em>) – Name for the new frame</p></li>
<li><p><strong>p</strong> (<em>ndarray</em>) – 3D position offset from parent frame</p></li>
<li><p><strong>rpy</strong> (<em>ndarray</em>) – Roll-pitch-yaw angles for frame orientation</p></li>
<li><p><strong>model</strong> (<em>pin.Model</em>) – Robot model to add frame to</p></li>
<li><p><strong>data</strong> (<em>pin.Data</em>) – Robot data structure</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>ID of newly created frame</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently hardcoded to attach to “arm_7_joint”. This should be made
configurable in future versions.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="figaroh.calibration.calibration_tools.add_pee_name">
<span class="sig-prename descclassname"><span class="pre">figaroh.calibration.calibration_tools.</span></span><span class="sig-name descname"><span class="pre">add_pee_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/figaroh/calibration/calibration_tools.html#add_pee_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#figaroh.calibration.calibration_tools.add_pee_name" title="Link to this definition"></a></dt>
<dd><p>Add end-effector marker parameters to parameter list.</p>
<p>Adds parameters for each active measurement DOF of each marker.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>param</strong> – Parameter dictionary containing:
- NbMarkers: Number of markers
- measurability: List of booleans for active DOFs
- param_name: List of parameter names to update</p>
</dd>
</dl>
<dl class="simple">
<dt>Side Effects:</dt><dd><p>Modifies param[“param_name”] in place by appending marker parameters
in format: “{param_type}_{marker_num}”</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="figaroh.calibration.calibration_tools.calc_updated_fkm">
<span class="sig-prename descclassname"><span class="pre">figaroh.calibration.calibration_tools.</span></span><span class="sig-name descname"><span class="pre">calc_updated_fkm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/figaroh/calibration/calibration_tools.html#calc_updated_fkm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#figaroh.calibration.calibration_tools.calc_updated_fkm" title="Link to this definition"></a></dt>
<dd><p>Update forward kinematics with world frame transformations.</p>
<p>Specialized version that explicitly handles transformations between:
1. World frame to start frame (wMo)
2. Start frame to end frame (oMee)
3. End frame to marker frame (eeMf)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>pin.Model</em>) – Robot model to update</p></li>
<li><p><strong>data</strong> (<em>pin.Data</em>) – Robot data</p></li>
<li><p><strong>var</strong> (<em>ndarray</em>) – Parameter vector matching param[“param_name”]</p></li>
<li><p><strong>q</strong> (<em>ndarray</em>) – Joint configurations matrix (n_samples, n_joints)</p></li>
<li><p><strong>param</strong> (<em>dict</em>) – Calibration parameters containing:
- Frames and parameters from update_forward_kinematics()
- NbMarkers=1 (only supports single marker)</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em>) – Print update info. Defaults to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Flattened marker measurements in world frame</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Excludes joint elasticity effects</p></li>
<li><p>Requires base or end-effector parameters in param_name</p></li>
<li><p>Validates all parameters are properly updated</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="figaroh.calibration.calibration_tools.calculate_base_kinematics_regressor">
<span class="sig-prename descclassname"><span class="pre">figaroh.calibration.calibration_tools.</span></span><span class="sig-name descname"><span class="pre">calculate_base_kinematics_regressor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol_qr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/figaroh/calibration/calibration_tools.html#calculate_base_kinematics_regressor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#figaroh.calibration.calibration_tools.calculate_base_kinematics_regressor" title="Link to this definition"></a></dt>
<dd><p>Calculate base regressor matrix for calibration parameters.</p>
<p>Identifies base (identifiable) parameters by:
1. Computing regressors with random/given configurations
2. Eliminating unidentifiable parameters
3. Finding independent regressor columns</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q</strong> (<em>ndarray</em>) – Joint configurations matrix</p></li>
<li><p><strong>model</strong> (<em>pin.Model</em>) – Robot model</p></li>
<li><p><strong>data</strong> (<em>pin.Data</em>) – Robot data</p></li>
<li><p><strong>param</strong> (<em>dict</em>) – Contains calibration settings:
- free_flyer: Whether base is floating
- calib_model: Either “joint_offset” or “full_params”</p></li>
<li><p><strong>tol_qr</strong> (<em>float</em><em>, </em><em>optional</em>) – QR decomposition tolerance. Defaults to TOL_QR.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Rrand_b (ndarray): Base regressor from random configs</p></li>
<li><p>R_b (ndarray): Base regressor from given configs</p></li>
<li><p>R_e (ndarray): Full regressor after eliminating unidentifiable params</p></li>
<li><p>paramsrand_base (list): Names of base parameters from random configs</p></li>
<li><p>paramsrand_e (list): Names of identifiable parameters</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
<dl class="simple">
<dt>Side Effects:</dt><dd><ul class="simple">
<li><p>Updates param[“param_name”] with identified base parameters</p></li>
<li><p>Prints regressor matrix shapes</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="figaroh.calibration.calibration_tools.calculate_identifiable_kinematics_model">
<span class="sig-prename descclassname"><span class="pre">figaroh.calibration.calibration_tools.</span></span><span class="sig-name descname"><span class="pre">calculate_identifiable_kinematics_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/figaroh/calibration/calibration_tools.html#calculate_identifiable_kinematics_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#figaroh.calibration.calibration_tools.calculate_identifiable_kinematics_model" title="Link to this definition"></a></dt>
<dd><p>Calculate identifiable Jacobian and regressor matrices.</p>
<p>Builds aggregated Jacobian and regressor matrices from either:
1. Given set of configurations, or
2. Random configurations if none provided</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – Joint configurations matrix. If empty, uses random configs.</p></li>
<li><p><strong>model</strong> (<em>pin.Model</em>) – Robot model</p></li>
<li><p><strong>data</strong> (<em>pin.Data</em>) – Robot data</p></li>
<li><p><strong>param</strong> (<em>dict</em>) – Parameters containing:
- NbSample: Number of configurations
- calibration_index: Number of active DOFs
- start_frame, end_frame: Frame names
- calib_model: Model type</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Either:</dt><dd><ul class="simple">
<li><p>Joint offset case: Frame Jacobian matrix</p></li>
<li><p>Full params case: Kinematic regressor matrix</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Removes rows corresponding to inactive DOFs and zero elements</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="figaroh.calibration.calibration_tools.calculate_kinematics_model">
<span class="sig-prename descclassname"><span class="pre">figaroh.calibration.calibration_tools.</span></span><span class="sig-name descname"><span class="pre">calculate_kinematics_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/figaroh/calibration/calibration_tools.html#calculate_kinematics_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#figaroh.calibration.calibration_tools.calculate_kinematics_model" title="Link to this definition"></a></dt>
<dd><p>Calculate Jacobian and kinematic regressor for single configuration.</p>
<p>Computes frame Jacobian and kinematic regressor matrices for tool frame
at given joint configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_i</strong> (<em>ndarray</em>) – Joint configuration vector</p></li>
<li><p><strong>model</strong> (<em>pin.Model</em>) – Robot model</p></li>
<li><p><strong>data</strong> (<em>pin.Data</em>) – Robot data</p></li>
<li><p><strong>param</strong> (<em>dict</em>) – Parameters containing “IDX_TOOL” frame index</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>model (pin.Model): Updated model</p></li>
<li><p>data (pin.Data): Updated data</p></li>
<li><p>R (ndarray): (6,6n) Kinematic regressor matrix</p></li>
<li><p>J (ndarray): (6,n) Frame Jacobian matrix</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="figaroh.calibration.calibration_tools.cartesian_to_SE3">
<span class="sig-prename descclassname"><span class="pre">figaroh.calibration.calibration_tools.</span></span><span class="sig-name descname"><span class="pre">cartesian_to_SE3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/figaroh/calibration/calibration_tools.html#cartesian_to_SE3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#figaroh.calibration.calibration_tools.cartesian_to_SE3" title="Link to this definition"></a></dt>
<dd><p>Convert cartesian coordinates to SE3 transformation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>ndarray</em>) – (6,) array with [x,y,z,rx,ry,rz] coordinates</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>SE3 transformation with:</dt><dd><ul class="simple">
<li><p>translation from X[0:3]</p></li>
<li><p>rotation matrix from RPY angles X[3:6]</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pin.SE3</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="figaroh.calibration.calibration_tools.get_LMvariables">
<span class="sig-prename descclassname"><span class="pre">figaroh.calibration.calibration_tools.</span></span><span class="sig-name descname"><span class="pre">get_LMvariables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/figaroh/calibration/calibration_tools.html#get_LMvariables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#figaroh.calibration.calibration_tools.get_LMvariables" title="Link to this definition"></a></dt>
<dd><p>Initialize variables for Levenberg-Marquardt optimization.</p>
<p>Creates initial parameter vector either as zeros or random values within bounds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param</strong> (<em>dict</em>) – Parameter dictionary containing:
- param_name: List of parameter names to initialize</p></li>
<li><p><strong>mode</strong> (<em>int</em><em>, </em><em>optional</em>) – Initialization mode:
- 0: Zero initialization
- 1: Random uniform initialization. Defaults to 0.</p></li>
<li><p><strong>seed</strong> (<em>float</em><em>, </em><em>optional</em>) – Range [-seed,seed] for random init. Defaults to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>var (ndarray): Initial parameter vector</p></li>
<li><p>nvar (int): Number of parameters</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">get_LMvariables</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(42,)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="figaroh.calibration.calibration_tools.get_geo_offset">
<span class="sig-prename descclassname"><span class="pre">figaroh.calibration.calibration_tools.</span></span><span class="sig-name descname"><span class="pre">get_geo_offset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">joint_names</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/figaroh/calibration/calibration_tools.html#get_geo_offset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#figaroh.calibration.calibration_tools.get_geo_offset" title="Link to this definition"></a></dt>
<dd><p>Get dictionary of geometric parameter variations.</p>
<p>Creates mapping of geometric offset parameters for each joint’s
position and orientation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>joint_names</strong> – List of joint names from robot model</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Mapping of geometric parameter names to initial zero values.</dt><dd><p>Keys have format: “d_{param}_{joint_name}” where param is:
- px, py, pz: Position offsets
- phix, phiy, phiz: Orientation offsets</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">geo_params</span> <span class="o">=</span> <span class="n">get_geo_offset</span><span class="p">(</span><span class="n">robot</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">geo_params</span><span class="p">[</span><span class="s2">&quot;d_px_joint1&quot;</span><span class="p">])</span>
<span class="go">0.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="figaroh.calibration.calibration_tools.get_joint_offset">
<span class="sig-prename descclassname"><span class="pre">figaroh.calibration.calibration_tools.</span></span><span class="sig-name descname"><span class="pre">get_joint_offset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">joint_names</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/figaroh/calibration/calibration_tools.html#get_joint_offset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#figaroh.calibration.calibration_tools.get_joint_offset" title="Link to this definition"></a></dt>
<dd><p>Get dictionary of joint offset parameters.</p>
<p>Maps joint names to their offset parameters, handling special cases for
different joint types and multiple DOF joints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – Pinocchio robot model</p></li>
<li><p><strong>joint_names</strong> – List of joint names from model.names</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Mapping of joint offset parameter names to initial zero values.</dt><dd><p>Keys have format: “{offset_type}_{joint_name}”</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">offsets</span> <span class="o">=</span> <span class="n">get_joint_offset</span><span class="p">(</span><span class="n">robot</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">robot</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">offsets</span><span class="p">[</span><span class="s2">&quot;offsetRZ_joint1&quot;</span><span class="p">])</span>
<span class="go">0.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="figaroh.calibration.calibration_tools.get_param_from_yaml">
<span class="sig-prename descclassname"><span class="pre">figaroh.calibration.calibration_tools.</span></span><span class="sig-name descname"><span class="pre">get_param_from_yaml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">robot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calib_data</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/figaroh/calibration/calibration_tools.html#get_param_from_yaml"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#figaroh.calibration.calibration_tools.get_param_from_yaml" title="Link to this definition"></a></dt>
<dd><p>Parse calibration parameters from YAML configuration file.</p>
<p>Processes robot and calibration data to build a parameter dictionary containing
all necessary settings for robot calibration. Handles configuration of:
- Frame identifiers and relationships
- Marker/measurement settings
- Joint indices and configurations
- Non-geometric parameters
- Eye-hand calibration setup</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>robot</strong> (<em>pin.RobotWrapper</em>) – Robot instance containing model and data</p></li>
<li><p><strong>calib_data</strong> (<em>dict</em>) – Calibration parameters parsed from YAML file containing:
- markers: List of marker configurations
- calib_level: Calibration model type
- base_frame: Starting frame name
- tool_frame: End frame name
- free_flyer: Whether base is floating
- non_geom: Whether to include non-geometric params</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Parameter dictionary containing:</dt><dd><ul class="simple">
<li><p>robot_name: Name of robot model</p></li>
<li><p>NbMarkers: Number of markers</p></li>
<li><p>measurability: Measurement DOFs per marker</p></li>
<li><p>start_frame, end_frame: Frame names</p></li>
<li><p>base_to_ref_frame: Optional camera frame</p></li>
<li><p>IDX_TOOL: Tool frame index</p></li>
<li><p>actJoint_idx: Active joint indices</p></li>
<li><p>param_name: List of parameter names</p></li>
<li><p>Additional settings from YAML</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<dl class="simple">
<dt>Side Effects:</dt><dd><p>Prints warning messages if optional frames undefined
Prints final parameter dictionary</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">calib_data</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">config_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span> <span class="o">=</span> <span class="n">get_param_from_yaml</span><span class="p">(</span><span class="n">robot</span><span class="p">,</span> <span class="n">calib_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;NbMarkers&#39;</span><span class="p">])</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="figaroh.calibration.calibration_tools.get_rel_jac">
<span class="sig-prename descclassname"><span class="pre">figaroh.calibration.calibration_tools.</span></span><span class="sig-name descname"><span class="pre">get_rel_jac</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_frame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_frame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/figaroh/calibration/calibration_tools.html#get_rel_jac"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#figaroh.calibration.calibration_tools.get_rel_jac" title="Link to this definition"></a></dt>
<dd><p>Calculate relative Jacobian matrix between two frames.</p>
<p>Computes the difference between Jacobians of end_frame and start_frame,
giving the differential mapping from joint velocities to relative spatial velocity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>pin.Model</em>) – Robot model</p></li>
<li><p><strong>data</strong> (<em>pin.Data</em>) – Robot data</p></li>
<li><p><strong>start_frame</strong> (<em>str</em>) – Starting frame name</p></li>
<li><p><strong>end_frame</strong> (<em>str</em>) – Target frame name</p></li>
<li><p><strong>q</strong> (<em>ndarray</em>) – Joint configuration vector</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>(6, n) relative Jacobian matrix where:</dt><dd><ul class="simple">
<li><p>Rows represent [dx,dy,dz,wx,wy,wz] spatial velocities</p></li>
<li><p>Columns represent joint velocities</p></li>
<li><p>n is number of joints</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Updates forward kinematics before computing Jacobians</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="figaroh.calibration.calibration_tools.get_rel_kinreg">
<span class="sig-prename descclassname"><span class="pre">figaroh.calibration.calibration_tools.</span></span><span class="sig-name descname"><span class="pre">get_rel_kinreg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_frame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_frame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/figaroh/calibration/calibration_tools.html#get_rel_kinreg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#figaroh.calibration.calibration_tools.get_rel_kinreg" title="Link to this definition"></a></dt>
<dd><p>Calculate relative kinematic regressor between frames.</p>
<p>Computes frame Jacobian-based regressor matrix mapping small joint displacements
to spatial velocities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>pin.Model</em>) – Robot model</p></li>
<li><p><strong>data</strong> (<em>pin.Data</em>) – Robot data</p></li>
<li><p><strong>start_frame</strong> (<em>str</em>) – Starting frame name</p></li>
<li><p><strong>end_frame</strong> (<em>str</em>) – Target frame name</p></li>
<li><p><strong>q</strong> (<em>ndarray</em>) – Joint configuration vector</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(6, 6n) regressor matrix for n joints</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="figaroh.calibration.calibration_tools.get_rel_transform">
<span class="sig-prename descclassname"><span class="pre">figaroh.calibration.calibration_tools.</span></span><span class="sig-name descname"><span class="pre">get_rel_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_frame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_frame</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/figaroh/calibration/calibration_tools.html#get_rel_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#figaroh.calibration.calibration_tools.get_rel_transform" title="Link to this definition"></a></dt>
<dd><p>Get relative transformation between two frames.</p>
<p>Calculates the transform from start_frame to end_frame in the kinematic chain.
Assumes forward kinematics has been updated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>pin.Model</em>) – Robot model</p></li>
<li><p><strong>data</strong> (<em>pin.Data</em>) – Robot data</p></li>
<li><p><strong>start_frame</strong> (<em>str</em>) – Starting frame name</p></li>
<li><p><strong>end_frame</strong> (<em>str</em>) – Target frame name</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Relative transformation sMt from start to target frame</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pin.SE3</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>AssertionError</strong> – If frame names don’t exist in model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="figaroh.calibration.calibration_tools.get_sup_joints">
<span class="sig-prename descclassname"><span class="pre">figaroh.calibration.calibration_tools.</span></span><span class="sig-name descname"><span class="pre">get_sup_joints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_frame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_frame</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/figaroh/calibration/calibration_tools.html#get_sup_joints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#figaroh.calibration.calibration_tools.get_sup_joints" title="Link to this definition"></a></dt>
<dd><p>Get list of supporting joints between two frames in kinematic chain.</p>
<p>Finds all joints that contribute to relative motion between start_frame and
end_frame by analyzing their support branches in the kinematic tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>pin.Model</em>) – Robot model</p></li>
<li><p><strong>start_frame</strong> (<em>str</em>) – Name of starting frame</p></li>
<li><p><strong>end_frame</strong> (<em>str</em>) – Name of ending frame</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Joint IDs ordered from start to end frame, handling cases:</dt><dd><ol class="arabic simple">
<li><p>Branch entirely contained in another branch</p></li>
<li><p>Disjoint branches with fixed root</p></li>
<li><p>Partially overlapping branches</p></li>
</ol>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[int]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>AssertionError</strong> – If end frame appears before start frame in chain</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Excludes “universe” joints from returned list since they don’t
contribute to relative motion.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="figaroh.calibration.calibration_tools.load_data">
<span class="sig-prename descclassname"><span class="pre">figaroh.calibration.calibration_tools.</span></span><span class="sig-name descname"><span class="pre">load_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path_to_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">del_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/figaroh/calibration/calibration_tools.html#load_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#figaroh.calibration.calibration_tools.load_data" title="Link to this definition"></a></dt>
<dd><p>Load joint configuration and marker data from CSV file.</p>
<p>Reads marker positions/orientations and joint configurations from a CSV file.
Handles data validation, bad sample removal, and conversion to numpy arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path_to_file</strong> (<em>str</em>) – Path to CSV file containing recorded data</p></li>
<li><p><strong>model</strong> (<em>pin.Model</em>) – Robot model containing joint information</p></li>
<li><p><strong>param</strong> (<em>dict</em>) – Parameter dictionary containing:
- NbMarkers: Number of markers to load
- measurability: List indicating which DOFs are measured
- actJoint_idx: List of active joint indices
- config_idx: Configuration vector indices
- q0: Default configuration vector</p></li>
<li><p><strong>del_list</strong> (<em>list</em><em>, </em><em>optional</em>) – Indices of bad samples to remove. Defaults to [].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>PEEm_exp (ndarray): Flattened marker measurements of shape (n_active_dofs,)</p></li>
<li><p>q_exp (ndarray): Joint configurations of shape (n_samples, n_joints)</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>CSV file must contain columns:
- For each marker i: [xi, yi, zi, phixi, phiyi, phizi]
- Joint names matching model.names for active joints</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>KeyError</strong> – If required columns are missing from CSV</p>
</dd>
</dl>
<dl class="simple">
<dt>Side Effects:</dt><dd><ul class="simple">
<li><p>Prints joint headers</p></li>
<li><p>Updates param[“NbSample”] with number of valid samples</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="figaroh.calibration.calibration_tools.rank_in_configuration">
<span class="sig-prename descclassname"><span class="pre">figaroh.calibration.calibration_tools.</span></span><span class="sig-name descname"><span class="pre">rank_in_configuration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">joint_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/figaroh/calibration/calibration_tools.html#rank_in_configuration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#figaroh.calibration.calibration_tools.rank_in_configuration" title="Link to this definition"></a></dt>
<dd><p>Get index of joint in configuration vector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>pin.Model</em>) – Robot model</p></li>
<li><p><strong>joint_name</strong> (<em>str</em>) – Name of joint to find index for</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Index of joint in configuration vector q</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>AssertionError</strong> – If joint name does not exist in model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="figaroh.calibration.calibration_tools.read_config_data">
<span class="sig-prename descclassname"><span class="pre">figaroh.calibration.calibration_tools.</span></span><span class="sig-name descname"><span class="pre">read_config_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path_to_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/figaroh/calibration/calibration_tools.html#read_config_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#figaroh.calibration.calibration_tools.read_config_data" title="Link to this definition"></a></dt>
<dd><p>Read joint configurations from CSV file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>pin.Model</em>) – Robot model containing joint information</p></li>
<li><p><strong>path_to_file</strong> (<em>str</em>) – Path to CSV file containing joint configurations</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Matrix of shape (n_samples, n_joints-1) containing joint positions</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="figaroh.calibration.calibration_tools.update_forward_kinematics">
<span class="sig-prename descclassname"><span class="pre">figaroh.calibration.calibration_tools.</span></span><span class="sig-name descname"><span class="pre">update_forward_kinematics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/figaroh/calibration/calibration_tools.html#update_forward_kinematics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#figaroh.calibration.calibration_tools.update_forward_kinematics" title="Link to this definition"></a></dt>
<dd><p>Update forward kinematics with calibration parameters.</p>
<p>Applies geometric and kinematic error parameters to update joint placements
and compute end-effector poses. Handles:
1. Base/camera transformations
2. Joint placement offsets
3. End-effector marker frames
4. Joint elasticity effects</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>pin.Model</em>) – Robot model to update</p></li>
<li><p><strong>data</strong> (<em>pin.Data</em>) – Robot data</p></li>
<li><p><strong>var</strong> (<em>ndarray</em>) – Parameter vector matching param[“param_name”]</p></li>
<li><p><strong>q</strong> (<em>ndarray</em>) – Joint configurations matrix (n_samples, n_joints)</p></li>
<li><p><strong>param</strong> (<em>dict</em>) – Calibration parameters containing:
- calib_model: “full_params” or “joint_offset”
- start_frame, end_frame: Frame names
- actJoint_idx: Active joint indices
- measurability: Active DOFs</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em>) – Print update info. Defaults to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Flattened end-effector measurements for all samples</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>Side Effects:</dt><dd><ul class="simple">
<li><p>Modifies model joint placements temporarily</p></li>
<li><p>Reverts model to original state before returning</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="figaroh.calibration.calibration_tools.update_forward_kinematics_2">
<span class="sig-prename descclassname"><span class="pre">figaroh.calibration.calibration_tools.</span></span><span class="sig-name descname"><span class="pre">update_forward_kinematics_2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/figaroh/calibration/calibration_tools.html#update_forward_kinematics_2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#figaroh.calibration.calibration_tools.update_forward_kinematics_2" title="Link to this definition"></a></dt>
<dd><p>Update forward kinematics with multiple markers.</p>
<p>Similar to update_forward_kinematics() but handles multiple end-effector
markers. Each marker can have its own frame transformation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>pin.Model</em>) – Robot model to update</p></li>
<li><p><strong>data</strong> (<em>pin.Data</em>) – Robot data</p></li>
<li><p><strong>var</strong> (<em>ndarray</em>) – Parameter vector matching param[“param_name”]</p></li>
<li><p><strong>q</strong> (<em>ndarray</em>) – Joint configurations matrix (n_samples, n_joints)</p></li>
<li><p><strong>param</strong> (<em>dict</em>) – Calibration parameters containing:
- NbMarkers: Number of markers
- calibration_index: Active DOFs per marker
- Additional params from update_forward_kinematics()</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em>) – Print update info. Defaults to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Concatenated marker measurements for all samples</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>AssertionError</strong> – If number of markers doesn’t match frames</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="figaroh.calibration.calibration_tools.update_joint_placement">
<span class="sig-prename descclassname"><span class="pre">figaroh.calibration.calibration_tools.</span></span><span class="sig-name descname"><span class="pre">update_joint_placement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">joint_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xyz_rpy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/figaroh/calibration/calibration_tools.html#update_joint_placement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#figaroh.calibration.calibration_tools.update_joint_placement" title="Link to this definition"></a></dt>
<dd><p>Update joint placement with offset parameters.</p>
<p>Modifies a joint’s placement transform by adding position and orientation offsets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>pin.Model</em>) – Robot model to modify</p></li>
<li><p><strong>joint_idx</strong> (<em>int</em>) – Index of joint to update</p></li>
<li><p><strong>xyz_rpy</strong> (<em>ndarray</em>) – (6,) array of offsets:
- xyz_rpy[0:3]: Translation offsets (x,y,z)
- xyz_rpy[3:6]: Rotation offsets (roll,pitch,yaw)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated robot model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pin.Model</p>
</dd>
</dl>
<dl class="simple">
<dt>Side Effects:</dt><dd><p>Modifies model.jointPlacements[joint_idx] in place</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="figaroh.calibration.calibration_tools.xyzquat_to_SE3">
<span class="sig-prename descclassname"><span class="pre">figaroh.calibration.calibration_tools.</span></span><span class="sig-name descname"><span class="pre">xyzquat_to_SE3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xyzquat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/figaroh/calibration/calibration_tools.html#xyzquat_to_SE3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#figaroh.calibration.calibration_tools.xyzquat_to_SE3" title="Link to this definition"></a></dt>
<dd><p>Convert XYZ position and quaternion orientation to SE3 transformation.</p>
<p>Takes a 7D vector containing XYZ position and WXYZ quaternion and creates
an SE3 transformation matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>xyzquat</strong> (<em>ndarray</em>) – (7,) array containing:
- xyzquat[0:3]: XYZ position coordinates
- xyzquat[3:7]: WXYZ quaternion orientation</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Rigid body transformation with:</dt><dd><ul class="simple">
<li><p>Translation from XYZ position</p></li>
<li><p>Rotation matrix from normalized quaternion</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pin.SE3</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pos_quat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transform</span> <span class="o">=</span> <span class="n">xyzquat_to_SE3</span><span class="p">(</span><span class="n">pos_quat</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="identification.html" class="btn btn-neutral float-left" title="Identification" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="measurements.html" class="btn btn-neutral float-right" title="Measurements" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021-2025, Thanh Nguyen.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>